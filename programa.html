<!DOCTYPE html>
<html lang="es">
<head>
	<title>Prueba</title>
    <meta charset="UTF-8">
</head>
<body>
<label for="p0">Peso máximo</label><br>
<input type="number" id="p0"><br>
<label for="c0">Mínimo de cal</label><br>
<input type="number" id="c0"><br><br>
<button onclick="b1()">Añadir</button>
<button onclick="b2()">Quitar último</button>
<button onclick="b3()">Óptimo</button>
<p id="p"></p><div id="d"></div>
<script>
var l=0
function b1(){
	var d=document.createElement("div")
	d.id=`d${++l}`
	d.innerHTML=`<label>Elemento ${l}</label><br>
	<label for="p${l}">Peso</label><br>
	<input type="number" id="p${l}"><br>
	<label for="c${l}">Cal</label><br>
	<input type="number" id="c${l}"><br>`
	document.getElementById("d").appendChild(d)
}
function b2(){if(l>0) document.getElementById(`d${l--}`).remove()}
var f=s=>parseFloat(document.getElementById(s).value)
function b3(){
	for(var i=0;i<=l;i++) for(var j of 'pc'){
		var n=f(j+i)
		if(isNaN(n)||(j=='p'?n<=0:n<0)){
			document.getElementById("p").innerHTML=`Error. ${j=='p'?'Pes':'Cal 0 '}o positivo:
			 ${i==0?j=='p'?'Máximo':'Mínimo':`Elemento ${i}`}`
			return
		}
	}
	var conjuntos=[[]]//Hallé la siguiente línea mediante un cálculo
	for(var i=1;i<=l;i++) conjuntos=conjuntos.concat(conjuntos.map(c=>c.concat([i])))
	var maxp=f("p0")
	var minc=f("c0")
	var optimo=[]
	var m=maxp
	for(var c of conjuntos){
		var peso=0
		var cal=0
		for(var i of c){
			peso+=f('p'+i)
			cal+=f('c'+i)
		}
		if(cal>minc&&peso<m){
			optimo=c
			m=peso
		}
	}
	document.getElementById("p").innerHTML='Óptimo '+optimo
	var s='Combinaciones '
	for(var c of conjuntos) if(c.length>0){
		s+='['
		for(var i of c) s+=i+','
		s=s.substring(0,s.length-1)+']'
	}
	console.log(s)
}
</script>
</body>
</html>